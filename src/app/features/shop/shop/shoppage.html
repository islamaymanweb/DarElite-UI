<div class="luxury-shop">
  <!-- Mobile Search Bar -->
  <div class="mobile-search-container">
    <div class="mobile-search-bar">
      <input
        #mobileSearch
        type="text"
        class="mobile-search-input"
        placeholder="Search our collection..."
        [value]="searchTerm()"
        (keyup.enter)="OnSearch(mobileSearch.value)"
        (input)="onSearchInput(mobileSearch.value)"
      />
      <div class="search-actions">
        <button class="search-btn" (click)="OnSearch(mobileSearch.value)">
          <i class="fas fa-search"></i>
        </button>
        <button
          class="filter-toggle"
          [class.active]="isMobileFiltersOpen()"
          (click)="toggleMobileFilters()"
        >
          <i class="fas fa-filter"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Filter Overlay -->
  <div
    class="mobile-filter-overlay"
    [class.active]="isMobileFiltersOpen()"
    (click)="closeMobileFilters()"
  ></div>

  <!-- Main Shop Content -->
  <div class="shop-container">
    <div class="container">
      <div class="shop-layout">
        <!-- Luxury Filter Sidebar -->
        <aside
          class="luxury-sidebar"
          [class.mobile-open]="isMobileFiltersOpen()"
        >
          <div class="sidebar-header">
            <div class="sidebar-brand">
              <i class="fas fa-crown"></i>
              <h3>Refine Selection</h3>
            </div>
            <button class="reset-filters" (click)="resetAllFilters()">
              <i class="fas fa-refresh"></i>
              Reset All
            </button>
          </div>

          <!-- Intelligent Search -->
          <div class="filter-section">
            <div class="section-header">
              <i class="fas fa-search"></i>
              <h4>Discover Your Style</h4>
            </div>
            <div class="search-container">
              <input
                #desktopSearch
                type="text"
                class="luxury-search"
                placeholder="Search our curated collection..."
                [value]="searchTerm()"
                (keyup.enter)="OnSearch(desktopSearch.value)"
                (input)="onSearchInput(desktopSearch.value)"
              />
              <i class="fas fa-search search-icon"></i>
            </div>
          </div>

          <!-- Categories -->
          <div class="filter-section">
            <div class="section-header">
              <i class="fas fa-tags"></i>
              <h4>Collections</h4>
            </div>
            <div class="categories-list">
              <div
                class="category-item"
                [class.active]="ProductParam.CategoryId === 0"
                (click)="onCategorySelect(0)"
              >
                <span class="category-name">All Collections</span>
                <span class="product-count">{{ totalCount() }}</span>
              </div>
              @for (item of categories(); track item.id) {
              <div
                class="category-item"
                [class.active]="item.id === ProductParam.CategoryId"
                (click)="onCategorySelect(item.id)"
              >
                <span class="category-name">{{ item.name }}</span>
                <span class="product-count">â€¢</span>
              </div>
              }
            </div>
          </div>

          <!-- Sorting -->
          <div class="filter-section">
            <div class="section-header">
              <i class="fas fa-sort-amount-down"></i>
              <h4>Sort By</h4>
            </div>
            <select
              #sortSelect
              class="luxury-select"
              (change)="onSortChange($event)"
              [value]="ProductParam.Sort"
            >
              @for (item of SortingOption; track $index) {
              <option [value]="item.value">{{ item.name }}</option>
              }
            </select>
          </div>
        </aside>

        <!-- Main Content Area -->
        <main class="luxury-main">
          <!-- Results Header -->
          <div class="results-header">
            <div class="results-info">
              <h2 class="collection-title">Our Curated Collection</h2>
              <p class="results-count">
                @if (!isLoading() && !hasError()) { @if (hasProducts()) {
                Presenting <strong>{{ products().length }}</strong> of
                <strong>{{ totalCount() }}</strong> exquisite pieces } @else if
                (hasNoResults()) { No masterpieces match your criteria } }
              </p>
            </div>
          </div>

          <!-- Loading State -->
          @if (isLoading()) {
          <div class="luxury-loading">
            <div class="loading-content">
              <app-spinner
                [overlay]="false"
                [global]="false"
                color="primary"
                text="Curating your collection..."
              ></app-spinner>
              <div class="loading-skeleton">
                @for (item of [1,2,3,4,5,6]; track $index) {
                <div class="product-skeleton">
                  <div class="skeleton-image"></div>
                  <div class="skeleton-content">
                    <div class="skeleton-line short"></div>
                    <div class="skeleton-line medium"></div>
                    <div class="skeleton-line long"></div>
                  </div>
                </div>
                }
              </div>
            </div>
          </div>
          }

          <!-- Error State -->
          @if (hasError()) {
          <div class="luxury-error">
            <div class="error-illustration">
              <i class="fas fa-palette"></i>
            </div>
            <h3>Refinement in Progress</h3>
            <p>
              Our artisans are enhancing your experience. Please try again
              momentarily.
            </p>
            <button class="retry-btn" (click)="getAllProduct()">
              <i class="fas fa-redo"></i>
              Try Again
            </button>
          </div>
          }

          <!-- No Results -->
          @if (hasNoResults()) {
          <div class="no-results">
            <div class="no-results-illustration">
              <i class="fas fa-search"></i>
            </div>
            <h3>No Masterpieces Found</h3>
            <p>
              @if (ProductParam.Search !== 'a' || ProductParam.CategoryId !== 0)
              { Your refined criteria didn't match our current collection.
              Consider broadening your selection. } @else { Our master craftsmen
              are creating new pieces. Visit us again for exquisite additions to
              our collection. }
            </p>
            @if (ProductParam.Search !== 'a' || ProductParam.CategoryId !== 0) {
            <button class="explore-btn" (click)="resetAllFilters()">
              <i class="fas fa-compass"></i>
              Explore All Collections
            </button>
            }
          </div>
          }

          <!-- Products Grid -->
          @if (hasProducts()) {
          <div class="products-section">
            <div class="luxury-grid" [class.list-view]="viewMode() === 'list'">
              @for (item of products(); track item.id; let i = $index) {
              <div
                class="product-card-wrapper"
                [style.animation-delay]="i * 0.1 + 's'"
              >
                <app-shop-item [Product]="item"></app-shop-item>
              </div>
              }
            </div>

            <!-- Premium Pagination -->
            @if (totalCount() > ProductParam.pageSize) {
            <div class="pagination-section">
              <app-pagination
                [pageSize]="ProductParam.pageSize"
                [totalCount]="totalCount()"
                [currentPage]="ProductParam.PageNumber"
                (pageChanged)="OnChangePage($event)"
                [boundaryLinks]="true"
                class="luxury-pagination"
              ></app-pagination>
            </div>
            }
          </div>
          }
        </main>
      </div>
    </div>
  </div>
</div>

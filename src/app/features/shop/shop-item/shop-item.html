<article class="product-card" [class.is-favorited]="isFavorited">
  <!-- Image Container -->
  <div class="card-image">
    <img
      [src]="getMainImage()"
      [alt]="Product.name"
      class="product-img"
      loading="lazy"
    />

    <!-- Discount Badge -->
    <div class="discount-badge" *ngIf="hasDiscount()">
      -{{ calculateDiscount(Product.oldPrice, Product.newPrice) }}%
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <button
        class="icon-btn"
        [class.active]="isFavorited"
        (click)="toggleFavorite($event)"
        aria-label="Favorite"
      >
        <svg
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
        >
          <path
            d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"
            [attr.fill]="isFavorited ? 'currentColor' : 'none'"
            stroke-width="2"
          />
        </svg>
      </button>

      <button
        class="icon-btn"
        (click)="shareProduct($event)"
        aria-label="Share"
      >
        <svg
          width="18"
          height="18"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <circle cx="18" cy="5" r="3" />
          <circle cx="6" cy="12" r="3" />
          <circle cx="18" cy="19" r="3" />
          <path d="M8.59 13.51l6.83 3.98M15.41 6.51l-6.82 3.98" />
        </svg>
      </button>
    </div>

    <!-- Multiple Images Indicator -->
    <div class="image-dots" *ngIf="hasMultipleImages()">
      <span
        *ngFor="let photo of Product.photos.slice(0, 3); let i = index"
        [class.active]="i === 0"
      ></span>
    </div>
  </div>

  <!-- Card Content -->
  <div class="card-content">
    <!-- Category -->
    <span class="category">Furniture</span>

    <!-- Product Name -->
    <h3 class="product-name">
      <a [routerLink]="['/product-details', Product.id]">{{ Product.name }}</a>
    </h3>

    <!-- Short Description -->
    <p class="description" *ngIf="Product.description">
      {{ Product.description.substring(0, 80) }}{{ Product.description.length >
      80 ? '...' : '' }}
    </p>

    <!-- Rating -->
    <div class="rating">
      <svg
        *ngFor="let star of getArrayofRating(5)"
        width="14"
        height="14"
        viewBox="0 0 24 24"
        fill="currentColor"
      >
        <path
          d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"
        />
      </svg>
      <span class="rating-text">(5.0)</span>
    </div>

    <!-- Price -->
    <div class="price-box">
      <span class="current-price"
        >EGP {{ Product.newPrice | number:'1.0-0' }}</span
      >
      <span class="old-price" *ngIf="hasDiscount()"
        >EGP {{ Product.oldPrice | number:'1.0-0' }}</span
      >
    </div>

    <!-- Actions -->
    <div class="card-actions">
      <button class="btn-primary" (click)="setBasketValue()">
        <svg
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <circle cx="9" cy="21" r="1" />
          <circle cx="20" cy="21" r="1" />
          <path
            d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"
          />
        </svg>
        Add to Cart
      </button>

      <a
        class="btn-secondary"
        [routerLink]="['/shop/product-details', Product.id]"
      >
        <i class="fas fa-info-circle"></i>
        View Details
      </a>
    </div>
  </div>
</article>
